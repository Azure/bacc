# Understanding AzFinSim

In this document we will dig into the AzFinSim application and understand how it works.
We will also look at various tools available for monitoring the application and inspecting the results
within the Azure ecosystem.

## Job details

AzFinSim is a synthetic financial simulation application that generates a large number of synthetic trades and then
processes them using a simple algorithm. The application is written in Python and designed to read trades from a CSV
file and write the results to another CSV file. When we use `sb azfinsim` to submit the job, it does the following:

* Creates a task named `generator` that generates the synthetic trades and writes them to a CSV file. The total number
  of trades generated is controlled by the `--num-trades` parameter.
* Creates a task named `splitter` that splits the generated trades into multiple files. The number of files is
  controlled by the `--num-tasks` parameter. Since this task has to run after the `generator` task, it is dependent
  on the `generator` task. Using task dependencies ensures that all required tasks are completed before a dependent
  task is started.
* Creates tasks named `pricing_*` to process each split file generated by the `splitter` task in parallel. The number
  of tasks is controlled by the `--num-tasks` parameter. Since these tasks have to run after the `splitter` task, they
  are dependent on the `splitter` task. Each of these tasks will save results a CSV file.
* Finally, the application creates a task named `merger` that merges the results from all the `pricing_*` tasks into a
  single CSV file. Since this task has to run after all the `pricing_*` tasks, it is dependent on all the `pricing_*`
  tasks.

These tasks are setup to read/write files to the shared storage account mounted on the compute nodes.

> __TODO__: add notes about using existing trades file.

## Using Azure Portal

> __TODO__: add notes about using Azure Portal for monitoring the job.

## Using Azure Batch Explorer

> __TODO__: add notes about using Azure Batch Explorer for monitoring the job.
